# DP スコアビューワ

## DP 非公式難易度表データについて

https://zasa.sakura.ne.jp/dp/run.php からデータを取得し、適切なフォーマットに変換した上で difficulty_table/ 下にファイルとして保存します。

`update_table` スクリプトを走らせることでこの更新処理を行い、最新の難易度表データを取り込むことができます。

https://zasa.sakura.ne.jp/dp/run.php の難易度表の構造は次の例のようになっています。なお、 BEGINNER および NORMAL 譜面の情報は含まれていません。

```
| 収録バージョン |
| HYPER 公式難易度 (非公式難易度) | ANOTHER 公式難易度 (非公式難易度) | LEGGENDARIA 公式難易度 (非公式難易度) | 曲名 |
```

例えば、以下の例では、 4th style で収録された ABSOLUTE という曲の HYPER 譜面の公式難易度は 8 、非公式難易度は 8.5 となります。

```
|                   4th style                     |
| ☆8 (8.5) | ☆11 (11.2) |	☆11 (11.8) | ABSOLUTE |
```

## 曲名ファジーマッチ

スコアデータ CSV の曲名と非公式難易度表の曲名は、特殊文字などの関係で一致していないことがあります。
`update_matching` スクリプトで、スコアデータ CSV サンプルに含まれる曲名と非公式難易度表に含まれる曲名をファジーマッチし、曲名が完全一致しないもののファジーマッチに成功した曲名についてテーブルを作成し、matching_table/ に保存します。
ビューワには非公式難易度表側の曲名を使用してください。

## クリア・スコア状況ビューワ

このアプリのメイン機能です。GitHub Pages にデプロイする Web アプリとして動作します。

公式サイトからダウンロードできるスコアデータ CSV （example_input/ 内にサンプルあり）を、この Web アプリに貼り付けまたはアップロードすることで、「DP 非公式難易度表」における非公式難易度別に整理されたクリア・スコア状況を確認することができます。

アップロードされた CSV は Local Storage に保存してください。

スコアデータ CSV には、未プレイの曲は含まれていません。DP 非公式難易度表に含まれていてスコアデータ CSV に含まれていない譜面は、NO PLAY 扱いにしてください。

楽曲リストは、まず非公式難易度表 (6.0、10.8など) 別にカテゴライズされ、その中でそれぞれユーザ指定の条件でソートされて表示されます。

ページングと、items per page ピッカーを実装してください。デフォルトは 1 ページ 10 曲とし、 Local Storage にピッカーの選択を保存してください。

### 各行のフォーマット

1行に1つの譜面の情報が含まれます。

```
| クリアタイプ | バージョン | 曲名 | HYPER / ANOTHER / LEGGENDARIA | ソート条件の値 |
```

ただし、クリアタイプは色だけでラベルとして示してください（FULL COMBO: オレンジ、EX HARD: 黄、HARD: 赤、CLEAR: 青、EASY: 緑、ASSIST: 紫、FAILED: 濃灰、NO PLAY: 薄灰）。

HYPER / ANOTHER / LEGGENDARIA は、黄色の H 、赤色の A、紫色の L で略記してください。

ソート条件の値には、例えばミスカウント順でソートしているならミスカウントの値が入ります。

* ソート条件
  * バージョン
  * タイトル
  * ミスカウント
  * クリアタイプ
  * 最終プレー日時

### 統計

各非公式難易度表ごとに、各クリアランプの個数と割合を一本の棒グラフで表してください。

### UI

デスクトップとスマホにそれぞれ最適化して、よく整理された UI を構築してください。

UI フレームワークには shadcn を使用してください。
